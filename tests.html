<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <title>Tests Taken ‚Äî StudyDeck</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="style.css" />
</head>


<body>
  <!-- Sidebar Navigation (same structure as index) -->
  <nav class="sidebar-nav">
    <div class="sidebar-logo">StudyDeck<span>.</span></div>
    <div class="sidebar-nav-links">
      <a href="index.html" class="sidebar-nav-link">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
          <polyline points="9 22 9 12 15 12 15 22"></polyline>
        </svg>
        <span>Home</span>
      </a>
      <a href="breakdown.html" class="sidebar-nav-link">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="12" y1="20" x2="12" y2="10"></line>
          <line x1="18" y1="20" x2="18" y2="4"></line>
          <line x1="6" y1="20" x2="6" y2="16"></line>
        </svg>
        <span>Progress</span>
      </a>
      <a href="tests.html" class="sidebar-nav-link active">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M4 7h16M4 12h16M4 17h10"></path>
          <circle cx="18" cy="17" r="2"></circle>
        </svg>
        <span>Tests</span>
      </a>
      <a href="rewards/rewards.html" class="sidebar-nav-link">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"></path>
        </svg>
        <span>Rewards</span>
      </a>
      <a href="profile.html" class="sidebar-nav-link">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
          <circle cx="12" cy="7" r="4"></circle>
        </svg>
        <span>Profile</span>
      </a>
    </div>
  </nav>

  <div class="app">
    <header class="top-nav">
      <div class="nav-left">
        <div class="logo" id="home-link">StudyDeck<span>.</span></div>
        <div class="nav-tagline">Smarter practice. Less time.</div>
      </div>
      <div class="nav-right">
        <a href="breakdown.html" class="nav-btn">View Progress</a>
        <a href="rewards/rewards.html" class="nav-btn">Rewards</a>
        <div id="userInfo"></div>
      </div>
    </header>

    <main class="page-main">
      <section class="card large" style="max-width:900px; margin:24px auto;">
        <h2>Tests Taken</h2>

        <p>Upload CSV files exported from your test records (or manually create entries). Files should include a header
          row such as <code>testDate,totalScore,reading,writing,math,notes</code>.</p>

        <div class="upload-row" style="gap:8px; margin-bottom:12px; align-items:center;">
          <button id="open-upload-modal" class="primary-btn">Upload CSV / PDF</button>
          <button id="view-scores-btn" class="ghost-btn">Refresh / View scores</button>
          <button id="clear-tests-btn" class="ghost-btn">Clear stored tests</button>
        </div>

        <!-- Manual add removed: use Edit on parsed/imported entries to correct fields -->

        <!-- Upload modal (drag & drop or click to select) -->
        <div id="upload-modal" class="modal hidden" aria-hidden="true">
          <div class="modal-backdrop" id="upload-backdrop"></div>
          <div class="modal-content upload-modal-content">
            <button id="upload-close-btn" class="modal-close">√ó</button>
            <h3>Upload test file</h3>
            <p>Drag and drop a CSV or PDF score report here, or click to choose a file.</p>
            <div id="upload-dropzone" class="upload-dropzone">
              <p class="muted">Drop file here</p>
              <input id="upload-input" type="file" accept=".csv,application/pdf" style="display:none" />
              <button id="upload-select-btn" class="ghost-btn">Select file</button>
            </div>
            <p class="hint" style="margin-top:8px;">CSV columns (recommended):
              <code>testDate,totalScore,reading,writing,math,notes</code>
            </p>
          </div>
        </div>

        <!-- Chart hidden by default to avoid empty/placeholder rendering when there are no scores.
       Tests JS can make this visible when data is available. -->
        <canvas id="score-trend" style="max-width:640px; height:120px; margin-top:18px; display:none;"></canvas>

        <div id="tests-list" style="margin-top:12px;">
          <p>Loading tests‚Ä¶</p>
        </div>

        <hr />

        <div id="test-details" class="card hidden" style="margin-top:12px;">
          <!-- detailed view populated by JS -->
        </div>

        <hr />

        <h3>Helpful resources</h3>
        <ul class="resource-list">
          <li><a href="https://collegereadiness.collegeboard.org/sat" target="_blank">Official SAT ‚Äî College Board</a>
          </li>
          <li><a href="https://www.khanacademy.org/test-prep/digital-sat" target="_blank">Khan Academy SAT practice</a>
          </li>
          <li><a
              href="https://www.kaptest.com/sat/free/sat-practice?srsltid=AfmBOopKXsute6clqDJfbRn9iBdiE6sJDXO9b-Vdpen19M93uEKZm9a7"
              target="_blank">Kaplan Test Prep</a></li>
          <li><a href="https://www.princetonreview.com/college/free-sat-practice-test" target="_blank">Test prep
              resources & tips</a></li>
        </ul>
      </section>
    </main>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <!-- PapaParse for robust CSV parsing -->
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.3.2/papaparse.min.js"></script>

  <!-- PDF.js for rendering PDFs to images -->
  <script src="https://cdn.jsdelivr.net/npm/pdfjs-dist@3.11.174/build/pdf.min.js"></script>
  <script>
    // Configure PDF.js worker
    if (typeof pdfjsLib !== 'undefined') {
      pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdn.jsdelivr.net/npm/pdfjs-dist@3.11.174/build/pdf.worker.min.js';
      console.log('‚úÖ PDF.js loaded and configured');
    } else {
      console.error('‚ùå PDF.js failed to load!');
    }
  </script>

  <!-- 
    üîë TO USE PDF UPLOAD: 
    1. Get a free Gemini API key at: https://aistudio.google.com/apikey
    2. Open tests.js and replace "YOUR_API_KEY_HERE" with your actual key
  -->

  <script type="module" src="tests.js"></script>
  <script type="module">
    import './script.js';
  </script>
</body>

</html>